[["index.html", "Infectious Disease Genomic Epidemiology 2024 Workshop Info Class Photo Schedule Pre-work", " Infectious Disease Genomic Epidemiology 2024 Faculty: William Hsiao, Fiona Brinkman, Emma Griffiths, Jared Simpson, Ed Taboada, Andrew McArthur, Finlay Maguire, Gary Van Domselaar, Robert Beiko May 13, 2024 - May 17, 2024 Workshop Info Welcome to the 2024 Infectious Disease Genomic Epidemiology 2024 Canadian Bioinformatics Workshop webpage! Class Photo Schedule Time (PST) Time (EST) Monday, May 13 Time (PST) Time (EST) Tuesday, May 14 Time (PST) Time (EST) Wednesday, May 15 Time (PST) Time (EST) Thursday, May 16 Time (PST) Time (EST) Friday, May 17 8:45 11:45 Zoom opens 8:00 11:00 Optional: Integrative Assignment Review (Hamilton TAs) 8:00 11:00 Optional: Integrative Assignment Review (Hamilton TAs) 8:00 11:00 Optional: Integrative Assignment Review (Hamilton TAs) 8:00 11:00 Optional: Integrative Assignment Review (Hamilton TAs) 9:00 12:00 Welcome (Nia Hughes) 9:00 12:00 Module 3: Data Curation and Data Sharing (Emma Griffiths) 9:00 12:00 Module 5: Viral Pathogen Genomic Analysis - Single Nucleotide Variants (Jared Simpson) 9:00 12:00 Module 6 Lab pt.2: Bacterial Pathogen Genomic Analysis - Genome-based Subtyping (Ed Taboada) 9:00 12:00 Module 8 Lab: Phylodynamics (Finlay Maguire) 9:30 12:30 AWS review (Zhibin Lu) 10:00 13:00 Module 3 Lab pt. 1: Data Curation and Data Sharing (Emma Griffiths) 10:00 13:00 Module 5 Lab pt. 1: Viral Pathogen Genomic Analysis - Single Nucleotide Variants (Jared Simpson) 10:00 13:00 Module 7: Antimicrobial Resistant Gene (AMR) Analysis (Andrew McArthur) 10:00 13:00 Module 9: Mobile Genetic Elements (Rob Beiko) 10:00 13:00 Module 1: Introduction to Genomic Epidemiology (William Hsiao) 11:00 14:00 Break (20 min) 11:00 14:00 Break (20 min) 11:00 14:00 Break (20 min) 11:00 14:00 Break (20 min) 11:00 14:00 Break (20 min) 11:20 14:20 Module 2: De Novo Genome Assembly and Annotation (Gary van Domselaar) 11:20 14:20 Module 3 Lab pt. 2: Data Curation and Data Sharing (Emma Griffiths) 11:20 14:20 Module 5 Lab pt. 2: Viral Pathogen Genomic Analysis - Single Nucleotide Variants (Jared Simpson) 11:20 14:20 Module 7 Lab pt. 1: Antimicrobial Resistant Gene (AMR) Analysis (Andrew McArthur) 11:20 14:20 Module 9 Lab: Mobile Genetic Elements (Rob Beiko) 12:20 15:20 Break (50 min) 12:20 15:20 Break (50 min) 12:20 15:20 Break (50 min) 12:20 15:20 Break (50 min) 12:20 15:20 Break (50 min) 13:10 16:10 Module 2: De Novo Genome Assembly and Annotation (Gary van Domselaar) 13:10 16:10 Module 4: Phylogenetic Analysis (Fiona Brinkman) - lecture 13:10 16:10 Module 6: Bacterial Pathogen Genomic Analysis - Genome-based Subtyping (Ed Taboada) 13:10 16:10 Module 7 Lab pt. 2: Antimicrobial Resistant Gene (AMR) Analysis (Andrew McArthur) 13:10 16:10 Module 10: Emerging Pathogen Detection and Identification (Gary van Domselaar) 14:40 17:40 Break (20 min) 14:10 17:10 Break (20 min) 14:10 17:10 Break (20 min) 14:10 17:10 Break (20 min) 14:10 17:10 Module 10 Lab: Emerging Pathogen Detection and Identification (Gary van Domselaar) 15:00 18:00 Introduction to Integrative Assignment 14:30 17:30 Module 4: Phylogenetic Analysis (Fiona Brinkman) - interactive portion 14:30 17:30 Module 6 Lab pt.1: Bacterial Pathogen Genomic Analysis - Genome-based Subtyping (Ed Taboada) 14:30 17:30 Module 8: Phylodynamics (Finlay Maguire) 15:40 18:40 Integrative Assignment Review 16:00 19:00 Finished 15:00 18:00 Finished 15:30 18:30 Finished 15:30 18:30 Finished 16:10 19:10 Survey and Closing Remarks 16:00 19:00 Optional: Integrative Assignment Review (Vancouver TAs) 16:30 19:30 Optional: Integrative Assignment Review (Vancouver TAs) 16:30 19:30 Optional: Integrative Assignment Review (Vancouver TAs) 16:30 19:30 Finished Pre-work You can find your pre-work here. "],["meet-your-faculty.html", "Meet Your Faculty", " Meet Your Faculty William Hsiao Associate Professor Faculty of Health Sciences, Simon Fraser University Vancouver, BC, CA wwhsiao@sfu.ca Website: https://cidgoh.ca/ William Hsiao is a public health infectious disease researcher with a background in microbial genomics and bioinformatics. He is an associate professor in the Faculty of Health Sciences at Simon Fraser University and an affiliated researcher at BCCDC Public Health Laboratory and at Canada’s Michael Smith Genome Sciences Centre. Will leads an interdisciplinary group of researchers interested in solving practical public health and animal health problems through a One Health lens at the Centre for Infectious Disease Genomics and One Health. Jared Simpson Principal Investigator, Ontario Institute for Cancer Research Assistant Prof. Department of Computer Science, University of Toronto Website: https://simpsonlab.github.io/ Dr. Simpson develops algorithms and software for the analysis of high-throughput sequencing data. He is interested in de novo assembly and the detection of sequence variation in individuals, cancers and populations, with a focus on long read sequencing technologies. Dr. Simpson developed the ABYSS, SGA and nanopolish software packages. Fiona Brinkman Distinguished Professor, FRSC, Department of Molecular Biology and Biochemistry Associate Member, School of Computing Science and Faculty of Health Sciences, Simon Fraser Univeristy Burnaby, BC, Canada brinkman@sfu.ca Website: https://www.brinkmanlab.ca/ Dr. Brinkman is developing bioinformatic resources to better track infectious diseases using genomic data, and improve prediction of new vaccine/drug targets. Her primary aim is to develop more sustainable, integrated approaches for infectious disease control, however she is also applying her methods to aid allergy, child health, and environmental research. Rob Beiko Professor Faculty of Computer Science, Dalhousie University Halifax, NS, Canada rbeiko@dal.ca Rob Beiko is a professor in bioinformatics whose research encompasses microbial evolution and gene transfer, comparative genomics, and microbial community analysis. He is the lead of the ARETE project, which is developing a software pipeline for annotation of AMR and mobile genetic elements, phylogenomic analysis, and inference of recombination and transfer in large sets of pathogen genomes. He has also developed and contributed to software tools including STAMP for statistical analysis of metagenome profiles, rSPR for efficient inference of gene transmission, and PICRUSt for the prediction of metagenome composition based on marker-gene surveys. Finlay Maguire Assistant Professor Faculty of Computer Science and Department of Community Health &amp; Epidemiology, Dalhousie Univerisity Halifax, NS, Canada finlay.maguire@dal.ca Website: finlaymagui.re Finlay Maguire is a genomic epidemiologist whose work centers on leveraging data in innovative ways to answer questions related to applied health and social issues. This includes developing bioinformatics methods to more effectively use genomic data to mitigate infectious diseases and broad interdisciplinary collaborations in areas such as refugee healthcare provision and online radicalisation. They are an active contributor to the national and international public health responses to emerging viral zoonoses and antimicrobial resistance, co-chair of the PHA4GE data structures working group, and act as a Pathogenomics Bioinformatics Lead for Sunnybrook’s Shared Hospital Laboratory. Gary Van Domselaar Chief, Bioinformatics National Microbiology Laboratory Public Health Agency of Canada Winnipeg, MB, Canada gary.vandomselaar@phac-aspc.gc.ca Dr. Gary Van Domselaar, PhD (University of Alberta, 2003) is the Chief of the Bioinformatics Section at the National Microbiology Laboratory in Winnipeg Canada and Associate Professor in the Department of Medical Microbiology and Infectious Diseases at the University of Manitoba. Dr. Van Domselaar’s lab develops bioinformatics methods and pipelines to understand, track, and control circulating infectious diseases in Canada and globally. His research and development activities span metagenomics, infectious disease genomic epidemiology, genome annotation, population structure analysis, and microbial genome wide association studies. Ed Taboada Research Scientist Genomic Epidemiology Research Unit Division of Enteric Diseases National Microbiology Laboratory Public Health Agency of Canada Winnipeg, MB, Canada eduardo.taboada@phac-aspc.gc.ca Eduardo Taboada is a research scientist in the Division of Enteric Diseases at the NML. Since obtaining his PhD in molecular genetics at the Department of Biology, University of Ottawa in 1999, he has applied his expertise in molecular biology and population genetics towards the development of comparative genomics and bioinformatics-based tools for studying various aspects of the biology, ecology, and epidemiology of bacterial food- and waterborne pathogens, with a focus on Campylobacter, Salmonella, and E. coli. Over these past two decades, Ed has led or participated in several projects funded by Genome Canada and the federal government’s Genomics Research and Development Initiative. His current research focus is on developing quantitative tools for integrated genomic and epidemiologic analysis and the application of analytical epidemiology approaches to genomic datasets. Emma Griffiths Research Associate Faculty of Health Sciences, Simon Fraser University Vancouver, BC, Canada emma_griffiths@sfu.ca Emma Griffiths is a research associate at the Centre for Infectious Disease Genomics and One Health (CIDGOH) in the Faculty of Health Sciences at Simon Fraser University in Vancouver, Canada. Her work focuses on developing and implementing ontologies and data standards for public health and food safety genomics to help improve data harmonization and integration. She is a member of the Standards Council of Canada and leads the Public Health Alliance for Genomic Epidemiology (PHA4GE) Data Structures Working Group. Andrew McArthur Professor Michael G. DeGroote Institute for Infectious Disease Research Department of Biochemistry and Biomedical Sciences McMaster University Hamilton, Ontario, Canada Dr. McArthur is a Professor and David Braley Chair in Computational Biology at McMaster University. Dr. McArthur has had a career in the United States and Canada, including NIH-funded positions at the Marine Biological Laboratory and Brown University, where he led the genome assembly of the diarrheal pathogen Giardia intestinalis, plus 10 years of experience in the private sector. Dr. McArthur’s research team focuses on building tools, databases, and algorithms for the genomic surveillance of infectious pathogens. He and his team developed the Comprehensive Antibiotic Resistance Database (card.mcmaster.ca) and the SARS-CoV-2 Illumina GeNome Assembly Line software platform. Darian Hole Bioinformatician Computational and Operational Genomics Unit National Microbiology Laboratory Public Health Agency of Canada Winnipeg, MB, Canada darian.hole@phac-aspc.gc.ca Darian Hole is a bioinformatician at the Public Health Agency of Canada working under Dr. Andrea Tyler and Dr. Ana Duggan. He focuses on genomic analysis process development, validation, and automation along with assisting partner labs in bringing in genomics to their workflows. Darian has mostly focused on viral diseases the past 5 years working at implementing standards, automation, and guidelines for SARS-CoV-2, Mpox, Polio, and Influenza. Karyn Mukiri PhD Graduate Student Researcher Faculty of Health Sciences, McMaster University Department of Biochemistry and Biomedical Sciences Hamilton, ON, Canada mukirikm@mcmaster.ca Karyn is a PhD student under the supervision of Dr. Andrew McArthur where her main research focus is on the development of predictive genomic annotation algorithms to increase antibiotic resistance surveillance by the Resistance Gene Identifier. She is also a McMaster alum, having completed her undergraduate degree in Biotechnology under the Faculty of Engineering. Although the bulk of her work focuses on more algorithmic problems, her current research efforts are in helping pinpoint instances of miscuration within the Comprehensive Antibiotic Resistance Database. Miguel Prieto PhD Graduate Student Researcher Faculty of Health Sciences, Simon Fraser University Vancouver, BC, Canada mprietog@sfu.ca Miguel is a first year PhD student studying the impact of human infectious diseases and the role of the microbiome in humans. Particularly, he aims to use machine learning and metagenomic analysis to predict poor outcomes in chronic respiratory diseases. Miguel is a Medical Doctor from the Universidad del Valle in Colombia and has worked as a researcher and project coordinator on translational studies of neglected tropical diseases like leishmaniasis. Before coming to SFU, he completed a Master of Experimental Medicine at UBC exploring blood-based gene expression biomarkers of nontuberculous mycobacterial infections in patients with cystic fibrosis. Madeline McCarthy PhD Graduate Student Researcher Department of Biochemistry and Biomedical Sciences McMaster University Hamilton, ON, Canada mccarm15@mcmaster.ca Madeline is a PhD Candidate in the McArthur Lab at McMaster University. Her work focuses on the development of targeted, cost-effective methods for culture-free outbreak detection and surveillance of bacterial pathogens. In addition to whole genome capture, she is testing the feasibility of targeted, culture-free plasmid recovery using bait capture and long-read sequencing. Prior to her PhD, she completed a MSc in microbiology at the University of Saskatchewan where she studied E. coli outbreaks in broiler chickens before hanging up her pipettes and switching to bioinformatics. Charlie Barclay MSc Graduate Student Researcher Department of Physics and Astronomy University of British Columbia Hamilton, ON, Canada cbarcl01@mail.ubc.ca Charlie is an ontology curator at the Centre for Infectious Disease Genomics and One Health (CIDGOH), focusing on data standards for contextual data of genomic epidemiology, including wastewater surveillance. With five years of experience in data management, specializing in biodiversity and genomics data, she also actively contributes to the Public Health Alliance for Genomic Epidemiology (PHA4GE) and the Global Alliance for Genomics and Health (GA4GH). Michelle Brazas Scientific Director Canadian Bioinformatics Workshops (CBW) Toronto, ON, CA support@bioinformatics.ca Dr. Michelle Brazas is the Associate Director for Adaptive Oncology at the Ontario Institute for Cancer Research (OICR), and acting Scientific Director at Bioinformatics.ca. Previously, Dr. Brazas was the Program Manager for Bioinformatics.ca and a faculty member in Biotechnology at BCIT. Michelle co-founded and runs the Toronto Bioinformatics User Group (TorBUG) now in its 11th season, and plays an active role in the International Society of Computational Biology where she sits on the Board of Directors and Executive Board. Nia Hughes Program Manager, Bioinformatics.ca Ontario Institute for Cancer Research Toronto, ON, Canada nia.hughes@oicr.on.ca Nia is the Program Manager for Bioinformatics.ca, where she coordinates the Canadian Bioinformatics Workshop Series. Prior to starting at OICR, she completed her M.Sc. in Bioinformatics from the University of Guelph in 2020 before working there as a bioinformatician studying epigenetic and transcriptomic patterns across maize varieties. Zhibin Lu Senior Manager, Digital Research University Health Network Toronto, ON, Canada zhibin@gmail.com Zhibin Lu is a senior manager at University Health Network Digital. He is responsible for UHN HPC operations and scientific software. He manages two HPC clusters at UHN, including system administration, user management, and maintenance of bioinformatics tools for HPC4health. He is also skilled in Next-Gen sequence data analysis and has developed and maintained bioinformatics pipelines at the Bioinformatics and HPC Core. He is a member of the Digital Research Alliance of Canada Bioinformatics National Team and Scheduling National Team. "],["data-and-compute-setup.html", "Data and Compute Setup", " Data and Compute Setup Course data downloads Coming soon! Compute setup Coming soon! "],["module-1-introduction-to-genomic-epidemiology.html", "Module 1: Introduction to Genomic Epidemiology Lecture", " Module 1: Introduction to Genomic Epidemiology Lecture "],["module-2-de-novo-genome-assembly-and-annotation.html", "Module 2: De Novo Genome Assembly and Annotation Lecture Lab Integrative Assignment 1 Integrative Assignment 2", " Module 2: De Novo Genome Assembly and Annotation Lecture Lab Integrative Assignment 1 Created by: Venus Lau and Jimmy Liu Introduction In this integrative assignment, you will be applying some of the genomic epidemiology analysis methods covered in this workshop. The focus of the assignment will be on Salmonella enterica, an enteric pathogen that primarily spreads by human consumption of contaminated foods in Canada and the United States. Here, you will examine isolates of Salmonella serovar Heidelberg from three epidemiologically distinct foodborne outbreaks that occurred in Quebec, Canada between 2012-2014. For more detailed background on how the outbreaks happened, you are encouraged to read over the original publication by Bekal et al. (2014). You will be analyzing the whole-genome sequencing (WGS) data generated from the study to investigate these foodborne outbreaks. Briefly, you will identify core genome single nucleotide variants (SNVs) from pre-assembled genomes, construct a core genome SNV phylogenetic tree and infer the evolutionary relationships of the isolates. In addition, you will annotate the bacterial genomes to detect the presence of various genetic features from this Salmonella outbreak dataset. The primary goal here is to integrate evidence from the phylogeny and genome annotations to justify which isolates are most likely epidemiologically linked (belong to the same outbreak). First, copy the assignment directory to your workspace on AWS: cp -r ~/CourseData/IDE_data/integrated_assignment_1/ ~/workspace/ cd ~/workspace/integrated_assignment_1 You can find the following files if you run the command ls ~/workspace/integrated_assignment_1: Assembled Salmonella genomes ~/workspace/integrated_assignment_1/assemblies Reference sequence (Heidelberg str. SL476) for variant calling: ~/workspace/integraintegrated_assignment_1/reference Metadata file ~/workspace/integrated_assignment_1/metadata.csv Required Tools Snippy FastTree ABRicate R Core Genome SNV Analysis To minimize the analysis runtime required, the SNV calling step using Snippy has already been done and you are provided a core genome SNV alignment to construct a phylogenetic tree in the next section. Additionally, you are provided a summary file that describes the number of SNVs identified and alignment statistics for each sample. SNV and alignment summary is located at: ~/workspace/integrated_assignment_1/alignment/core_aln_stats.txt Core genome alignment of the entire dataset is located at: ~/workspace/integrated_assignment_1/alignment/heidelberg_core.aln Description of SNV alignment summary headers: Header Description ID Sample identifier LENGTH Reference sequence length (bps) ALIGNED Reference sequence length aligned by query (bps) UNALIGNED Reference sequence length not aligned by query (bps) VARIANT Number of variants identified HET Number of heterozygous sites (mixed variants) MASKED Number of masked sites in reference sequence LOWCOV Number of aligned sites with low depth of coverage Review the summary file and the core genome alignment, and answer the following questions: 1. What is the length of the alignment and how is this length determined? Isolates of the same outbreak are more phylogenetically related (higher sequence similarity) than isolates collected from different outbreaks 2. Which isolate has the most detected variants relative to the reference genome? Which has the least? Isolates of the same outbreak are more phylogenetically related (higher sequence similarity) than isolates collected from different outbreaks 3. Which statistics in the variant calling summary file might be useful for identifying outlier (poor quality) samples and why? Isolates of the same outbreak are more phylogenetically related (higher sequence similarity) than isolates collected from different outbreaks Phylogenetic Analysis &amp; Visualization Here, you are tasked with using FastTree to construct a maximum likelihood tree from the core genome SNV alignment. When visualizing the phylogenetic tree, make note of any clustering patterns and which strains are closely/distantly related. To start, you will have to create your own environment with the needed tools (FastTree) and R packages (r-tidyverse and r-ggpubr). To do this you’ll use the following conda create command and then activate the environment: # Create command - 2 minutes conda create -n integrated-assignment-1 -c conda-forge -c bioconda fasttree r-tidyverse r-ggpubr --yes Hints Example FastTree usage: FastTree -nt sequence.aln &gt; tree.nwk. You’ll need to replace sequence.aln with the path to the correct alignment file Use the ggtree R package to generate a visualization of the phylogenetic tree (using your provided RStudio instance: xx.uhn-hpc.ca:8080, where xx is your assigned student number) Note ggtree is unavailable in your Rstudio session when you load it. Run the following commands to install and load it: if (!require(&quot;BiocManager&quot;, quietly = TRUE)) install.packages(&quot;BiocManager&quot;) # you can ignore if you get a warning message about the Bioconductor version BiocManager::install(&quot;ggtree&quot;) library(ggtree) Helpful Starter Code: # make sure you are in the folder of the assignment #load files metadata&lt;-read.csv(&quot;metadata.csv&quot;) tree&lt;-read.tree(&quot;tree.nwk&quot;) Additional Tree Documentation: Visualizing phylogenetic trees Adding metadata to your trees 4. What does the phylogenetic tree inform you about the relatedness of the isolates within the same outbreak and across different outbreaks? Isolates of the same outbreak are more phylogenetically related (higher sequence similarity) than isolates collected from different outbreaks 5. Do the isolates cluster by isolation source (e.g. Human, Food) or isolation date? Isolates tend to cluster by isolation date. ___ Genome Annotation Predicting genes and other functional elements (e.g. transcriptional elements, replication origins, mobile elements) can help explain the differences in biological, epidemiological, and ecological characteristics of microbial organisms. Genome annotations are also critical for risk assessments of infectious disease pathogens, as the detection of multiple antimicrobial resistance (AMR) or virulent genes are suggestive of high risks to public health or patient health that require immediate attention. Here, you will use a tool called ABRicate to search for the presence of plasmids, AMR genes and virulence factors (VF). You will need to search against three different nucleotide databases that contain reference sequences of curated elements. Once you have identified the genetic elements carried by the bacterial genomes, you will generate heatmaps to visualize the results and identify any correlations amongst within-outbreak strains and between-outbreak strains. But first, you must install the ABRicate tool into your conda environment to be able to use it: # Conda install - 1 minute conda install -c bioconda abricate --yes How to Run ABRicate: Example ABRicate usage: abricate --db db_name contigs.fa &gt; report.tab The main parameter, --db specifies which database you would like to search against. There are different databases for different genetic elements. You can find the list of pre-downloaded sequence databases by executing: abricate --list To search for AMR genes, virulence factors, and plasmids, the database names are card, vfdb, and plasmidfinder, respectively Once you have generated the required ABRicate outputs for all Salmonella genomes, combine the results of all genomes by executing: abricate --summary /path/to/amr_results_dir/*.tab &gt; amr_summary.tab How to Visualize ABRicate Summary Results If you feel like challenging yourself with data visualization using R, then feel free to skip the instructions in this section and proceed to write your own codes in RStudio to plot the heatmaps. To help with results visualization, we have prepared a R script to generate heatmap plots directly from ABRicate summary results: # Clone the IDE2021_integrated_hw GitHub repository to your current working directory git clone https://github.com/jimmyliu1326/IDE2021_integrated_hw # Inside the cloned repository, you will find a script called `abricate_heatmap.R` # Example usage of the script Rscript abricate_heatmap.R /path/to/amr_summary.tab /path/to/amr_heatmap.png Hints: You can only query one genome against one database at a time (How would you automate the search for multiple genomes?) For each database (card, vfdb, plasmidfinder), organize the annotation results in a different directory 6. Can you infer which isolates are epidemiologically linked and which isolates are sporadic cases based on the presence/absence of the plasmids? Yes, the pattern of presence/absence of plasmids is distinct in each outbreak. 7. Do you see the same trend with AMR genes or virulence factors? No, the majority of isolates, regardless of the outbreak of origin, exhibit the same trend in virulence factors and AMR genes. 8. Looking at the AMR heatmap, which samples likely contain AMR genes encoded on plasmids and how would you verify this looking at ABRicate results? SH14-009 and SH08-001, because the heatmaps show that they carry 1-2 unique AMR genes that are not present in any other genomes in the dataset. Furthermore, in the plasmids heatmap, we also observe that SH14-009 and SH08-001 carry unique plasmids; hence the unqiue AMR genes are most likely encoded by these unique plasmids. To verify this, we first identify the contig name associated with the unique plasmids from the invidiual abricate results. For example, based on the plasmids heatmap, we observe that SH14-009 carries the unique plasmid, IncI1_1_Alpha. Running: grep IncI_1_Alpha abricate/plasmids/SH14-009.tab, we find that the unique plasmid is associated with the contig name, CP016585.1 Subsequently, we can search in the AMR results of SH14-009 to identify AMR genes that are present in the contig CP016585.1 by running grep CP016585.1 abricate/amr/SH14-009.tab. And indeed, we find that the contig contains two AMR genes: AAC(3)-VIa and ANT(3’’)-IIa, which in fact are the two AMR genes unique to SH14-009! 9. Aside from plasmids, AMR genes and VF, can you think of other genetic features in bacterial genomes that may help discriminate between these outbreaks? CRISPR arrays, insertional elements, genomic Islands, phage elements, integrative conjugative elements Integrative Assignment 2 Introduction In late 2021, South Africa experienced a resurgence in SARS-CoV-2 cases that was accompanied by an increase of Spike-gene diagnostic assay PCR failures. This specific diagnostic characteristic was associated with the earlier Alpha Variant of Concern (VOC) and not of the currently circulating Delta VOC. Due to this, a targeted sequencing effort was initiated to investigate this unusual variant. A new, genetically distinct lineage was quickly identified. Cases linked to this lineage rapidly increased in both South Africa and subsequently worldwide with it being designated as a new WHO VOC called Omicron in under 10 days from the initial sequencing result. You are interested in performing a genomic epidemiological investigation of the source, evolutionary relationship, and genetic characteristics of this newly emergent lineage. To do this, you have randomly sampled a small subset of the global diversity of SARS-CoV-2 lineages hosted on GISAID from the onset of the pandemic until early 2022 supplemented with a subset of the first reported Omicron sequences from both South Africa and Canada. Important terms on variant typing of the SARS-CoV-2 virus: Pango Lineage / Lineage: Variant type called using the Pangolin tool which provides a finely-detailed nomenclature on the input genome based on all of the currently designated lineages. Nextstrain Clade / Clade: Variant typing called using the Nextstrain naming guidelines/tools. These clades are a bit more relaxed than the Pangolin lineages with the aim to new clades created by significant differences in biological impact or circulation patterns. WHO Variants of Concern: Variants designated by the WHO and given an easy to say greek alphabet label This integrated assignment will focus on the genomic epidemiological analysis of the emergence of the SARS-CoV-2 VOC Omicron using tools and methods covered in the other modules of the course. Once finished the assignment, check out the published paper on the epidemiological investigation of early Omicron from South Africa: Published Paper Viana, R., Moyo, S., Amoako, D.G. et al. Rapid epidemic expansion of the SARS-CoV-2 Omicron variant in southern Africa. Nature 603, 679–686 (2022). https://doi.org/10.1038/s41586-022-04411-y List of Software Utilized Augur mafft iqtree timetree Auspice Nextclade Rebar The workshop machines already have this software installed within a conda environment called integrated-assignment-2. Assignment Setup Copy Data Files To begin, we will copy over the assignment files to ~/workspace. Commands cp -r ~/CourseData/IDE_data/integrated_assignment_2/data/ ~/workspace/integrated_assignment_2 cd ~/workspace/integrated_assignment_2 This will copy over the 3 files that you need to do the assignment, which you can check with ls and should give: metadata.tsv selected_sequences.fasta sequences.fasta Activate Environment Activate the conda environment integrated-assignment-2 which has all of the tools used in this assignment. Verify your Workshop Machine URL This exercise will produce output files intended to be viewed in a web browser. These should be accessible by going to http://xx.uhn-hpc.ca in your web browser where xx is your particular number (like 01, 02, etc.). Phylogenetic Construction As seen previously in Module 8, we are going to construct a phylogenetic tree using the Augur tool suite, this time with a set of global SARS-CoV-2 sequences and their associated metadata subsampled from GISAID. Revisit that module to refamiliarize yourself with the commands if needed! You can also run COMMAND --help to gain more information on the parameters associated with each of the tools used. The structure of this section has all of the full commands hidden by default so you can practice constructing your own commands. It will take around 10 minutes total for the commands to execute. Tip When running through the assignment, remember to keep track of what you name your output files as each step builds off of the previously generated output files. If you are figuring out your own commands and comparing them to the full given commands there will likely be differences in these parameter inputs! Note There are some potential differences that can occur in the final tree topology due to the random seeding of the initial parsimony trees and the small number of iterations run (not running any bootstrapping). To enforce a common tree topology, we are going to use a fixed seed of 100 when building the trees. Step 1: Construct a Multiple Sequence Alignment Using augur align and the --reference-name Wuhan-Hu-1/2019 reference sequence that is found in the given sequences.fasta file, construct a multiple sequence alignment using four threads. Command and Parameters Command: # 1. Align with Augur using mafft - 2 min augur align \\ --nthreads 4 \\ --sequences sequences.fasta \\ --reference-name &#39;Wuhan-Hu-1/2019&#39; \\ --output aligned.fasta Parameters: --nthreads 4: Use 4 threads for the alignment --sequences sequences.fasta: Input set of sequences including the reference in fasta format --reference-name &#39;Wuhan-Hu-1/2019&#39;: The reference Wuhan-1 genome identifier found in our sequences file to remove insertions relative to --output aligned.fasta: Output alignment file in fasta format Step 2: Build a Maximum Likelihood Phylogenetic Tree Next, using augur tree and your newly generated multiple sequence alignment with --alignment, construct a maximum likelihood tree. Include the --tree-builder-args \"-seed 100\" parameter in your command to keep all assignment trees matching, and remember that output trees should be formatted in the newick format with the .nwk extension. Use four threads. Command and Parameters Command: # 2. Build Maximum Likelihood Phylogenetic Tree with Augur using iqtree2 - 40 sec augur tree \\ --nthreads 4 \\ --alignment aligned.fasta \\ --tree-builder-args &quot;-seed 100&quot; \\ --output tree.nwk Parameters: --nthreads 4: Use 4 threads for building the ML tree --alignment aligned.fasta`: Input multiple sequence alignment file from the previous step --tree-builder-args &quot;-seed 100&quot;: Seed given to iqtree to keep all output tree topology the same --output tree.nwk: Output phylogenetic tree in newick format Step 3: Infer Time Tree The next step is to infer a time tree using the augur refine --timetree command along with your multiple sequence alignment (--alignment), provided metadata, and newly generated maximum likelihood --tree newick file. Tip This is a long command; remember to add in the following parameters: Root your tree with the Wuhan 1 reference --root 'Wuhan-Hu-1/2019' Set your divergence units for visualizing later on --divergence-units mutations Set both of your output files --output-tree timetree.nwk and --output-node-data branch_lengths.json Add in the --seed 100 parameter Command and Parameters Command: # 3. Build time tree with Augur using timetree - 4 min augur refine \\ --timetree \\ --tree tree.nwk \\ --alignment aligned.fasta \\ --metadata metadata.tsv \\ --root &#39;Wuhan-Hu-1/2019&#39; \\ --divergence-units mutations \\ --output-tree timetree.nwk \\ --output-node-data branch_lengths.json \\ --seed 100 Parameters: --timetree: Specify that augur refine should build a time tree --tree tree.nwk: Input newick tree build using iqtree --alignment aligned.fasta: Input multiple sequence alignment from augur align --metadata metadata.tsv: Input metadata file containing the sequence names (column: `strain`) and collection dates (column: `date`) --root &#39;Wuhan-Hu-1/2019&#39;: Keep the Wuhan-1 reference genome as the root of the tree --divergence-units mutations: Convert the branch lengths to mutations for visualizing later on --output-tree timetree.nwk: Output time tree newick file --output-node-data branch_lengths.json: Output file to write branch lengths as node data --seed 100: Seed given to be used instead to keep tree topologies the same Step 4: Infer Ancestral States for Lineages/Clades Next, we are going to infer ancestral traits for the different typing schemes found in the metadata.tsv file. To do this, use the augur traits command along with the newly created timetree and the desired columns from the metadata file. The output should be set with --output-node-data. The --columns to use are: clade_who: The WHO designated clade (or blank if the sample is not in a WHO clade) clade_nextstrain: The clade designated by Nextstrain pangolin_lineage: The lineage assigned by the Pangolin lineage assignment pipeline Command and Parameters Step 5. Export for visualization Finally, export your visualization as an Auspice JSON file using augur export v2. The export command below should work if you have been using the names in the commands provided for you; otherwise, you may have to adjust the input file names for the –tree and –node-data arguments. Command and Parameters Command: # 4. Infer ancestral node traits for given columns - 20 seconds augur traits \\ --tree timetree.nwk \\ --metadata metadata.tsv \\ --columns clade_who pangolin_lineage clade_nextstrain \\ --output-node-data node_traits.json Parameters: --tree timetree.nwk: Input time tree created with augur refine --metadata metadata.tsv: Input metadata file with the information we have to infer ancestral states with --columns clade_who pangolin_lineage clade_nextstrain: The columns in the metadata file to use for inference --output-node-data node_traits.json: Output file to write trait inferences to Step 5: Export for Visualization Finally, export your visualization as an Auspice JSON file using augur export v2. The export command below should work if you have been using the names in the commands provided for you; otherwise, you may have to adjust the input file names for the --tree and --node-data arguments. Command and Parameters Command: # 5. Export tree to auspice json file - 20 sec augur export v2 \\ --tree timetree.nwk \\ --node-data branch_lengths.json node_traits.json \\ --maintainers &quot;CBW-IDE-2024&quot; \\ --title &quot;Integrated Assignment 2&quot; \\ --output auspice.json Parameters: --tree timetree.nwk: Input time tree created with augur refine --node-data branch_lengths.json node_traits.json: Input node data json files created in step 3 (branch length) and step 4 (traits) --maintainers &quot;CBW-IDE-2024&quot;: Maintainer name to be displayed by auspice. Can be whatever you like --title &quot;Integrated Assignment 2&quot;: Title to be displayed by auspice. Can be whatever you would like --output auspice.json: Output JSON file to be used in auspice for visualization and tree exploration Phylogenetic Visualization and Analysis Questions Visualize the tree using auspice to help answer the following questions. Step 1: Load Data into Auspice Download the ouput Auspice JSON file and the metadata.tsv file by right-clicking Save link as.... Go to https://auspice.us/ and drag and drop in the saved JSON file and the metadata.tsv file to visualize your created phylogenetic tree with metadata. Spend a bit exploring the tree and seeing where all of the clades are along with how the branch lengths compare when visualized by both Time and Divergence. Step 2: Answer the Following Questions Using the Visualization and Prompts Looking at the time phylogeny, find both Omicron and Delta on the tree (hint: Colour by “clade_who”). Noting that Omicron emerged when the Delta lineages were prevalent globally, from the phylogeny: 1. What can you infer about the relationship between the Delta and Omicron variants? 2. What is the lineage of the most recent common ancestor (MRCA) of both Delta and Omicron? (hint: Remember lineage is from Pangolin. Colour the tree by “pangolin_lineage”) Next, zoom in on the Omicron clade. 3. Based on your tree, where and when was the first Omicron case identified? Is there enough evidence in our tree to say this is where Omicron emerged? (Hint: Label tips by country, click on the nodes, explore around) The emergence of Omicron was characterized by three distinct lineages that were all detected at roughly the same time in the order of: BA.1, BA.2, and then BA.3. 4. When was the MRCA of all 3 of the Omicron lineages (BA.1, BA.2, and BA.3) predicted to be? What about BA.2 and BA.3? 5. What does this tell you about the diversification of the Omicron VOC prior to its detection in the population? Zooming back out, the Omicron clade has an unusually long branch length back to its most recent common ancestor suggesting a period of unsampled diversification of before its emergence. 6. Which lineage does Omicron appear to have diverged from? 7. How long a period of unsampled diversity do you estimate for the Omicron VOC based on the inferred dates? 8. Based on all of the previous answers, what hypotheses for the emergence of Omicron are consistent with your observations? Is there anything about the country of origin that suggests one hypothesis over another? Now, set the branch length from Time to Divergence and view the tree in a Radial layout. Colour by who_clade. 9. Do any of the other WHO VOCs (alpha, beta, gamma, delta) show a similar phylogenetic emergence structure to that of Omicron? What, if anything, can you conclude about the emergence of VOCs? Nextclade Analysis You are looking to explore the different molecular profiles of the VOCs by analysing and visualizing them using nextclade and comparing them to Omicron. Nextclade is a tool that performs genetic sequence alignment, clade assignment, mutation calling, phylogenetic placement, and quality checks for different viral pathogens. It can be run either on the command line or locally in your browser (no data leaves your computer!) Remember to keep your auspice tree open to assist in analyzing the VOCs. The WHO VOCs are: Alpha Beta Gamma Delta Omicron Step 1: Download the selected_sequences.fasta file to your computer and then load it into nextclade by dragging it into your browser. Then set the dataset to the official SARS-CoV-2 dataset and click run. Step 2: Using Nextclade, Answer the Following Questions Nextclade will show the distribution of mutations along either specific genes or over the whole genome with the default view being set to show mutations in the Spike protein. 10. The TaqPath three-gene RT-PCR assay for SARS-CoV-2 experienced diagnostic failures for Alpha due to the 69-70del mutation in one of the assay primers. This assay failed in the same target in some of the the initial Omicron lineages. Based on the nextclade visualization, which lineage(s) contain this mutation? Change the view from the default of spike to the ‘Nucleotide sequence’ option to view the full distribution of mutations across the genome 11. Can you find any other mutations in Omicron that are common to the other VOCs? Given the phylogenetic relationship of the VOCs, can you provide a hypothesis for your observation of common mutations between them? 12. In which gene(s) are the mutations of the VOCs concentrated? Why is this the case? Recombination Analysis With both of the Delta and Omicron VOCs circulating in the population at the same time in December 2021, there was ample opprotunity for co-infections to occur with a high probability of recombination events happening. This lead to the first “deltacron” recombinat being identified in France in January 2022. Recombinant SARS-CoV-2 sequences consist of genomic elements from two different lineages/variants with one or more breakpoints in which the recombination occured. To identify potential recombinants and breakpoints, we are going to use the tool rebar that follows the PHA4GE Guidance for Detecting and Characterizing SARS-CoV-2 Recombinants for detecting and visualizing SARS-CoV-2 recombination. Step 1: Download First, we have to download a version controlled SARS-CoV-2 dataset for rebar to be able to detect breakpoints and recombinants. For more information on what is contained in a dataset, checkout the rebar dataset page. As a quick introduction though, the dataset directory consists minimally of: The Wuhan-1 reference genome Population fasta file with known clades/lineages aligned to the reference To download the required dataset to be able to detect recombinants, you will have to use the rebar dataset download command. This command requires an input dataset name (--name sars-cov-2), an input date tag, which we will use --tag 2023-11-30 for, and an --output-dir to save the dataset to. Remember, you can almost always run TOOL --help to get more info on how to run a tool. Command and Parameters Command: Command: # 1. Download dataset to run rebar - 10 sec rebar dataset download \\ --name sars-cov-2 \\ --tag 2023-11-30 \\ --output-dir dataset/2023-11-30 Parameters: --name sars-cov-2: Input dataset name to grab --tag 2023-11-30: Input date tag for the dataset --output-dir dataset/2023-11-30: Output directory name to save the dataset to Step 2: Run Next, run the rebar run command using the newly created --dataset-dir and your initial aligned fasta file (--alignment) to begin the process of detecting any potential recombinant genomes in our input sequences. Output data again should be saved to a specified --output-dir. Command and Parameters Command: # 2. Run rebar detection - 2 minutes rebar run \\ --dataset-dir dataset/2023-11-30 \\ --alignment aligned.fasta \\ --output-dir rebar_recombination Parameters: --dataset-dir dataset/2023-11-30: Input SARS-CoV-2 dataset downloaded in the prior step --alignment aligned.fasta: Input aligned fasta file all the way back from augur align --output-dir rebar_recombination: Output directory for rebar to save to Step 3: Plot Finally, run rebar plot to create visualizations of the potential recombinants detected using the previous output --run-dir and the --annotations file found in your downloaded rebar dataset from step 1 (hint: This file is called annotations.tsv). Command and Parameters Command: Command: # 3. Plot rebar detections - 5 sec rebar plot \\ --run-dir rebar_recombination \\ --annotations dataset/2023-11-30/annotations.tsv Parameters: --run-dir rebar_recombination: Input directory containing rebar run results to be used for plotting --annotations dataset/2023-11-30/annotations.tsv: Input annotations file containing a table of genome annotations to add to the plot Questions Now view the PNG images produced by Rebar (found in rebar_recombination/plots) and answer the following questions for the XB, XD, and XF recombinants detected: 13. What lineages comprise the recombinant? 14. In which genes do recombination break points occur? With the knowledge of which samples were detected as recombinants along with which lineages make up their recombination, look back at the time tree and find the detected recombinant samples (hint: Colour by who_clade). 15. Where do the the XD and XF recombinant samples place on the phylogeny? Are they located where you’d expect based on their components? Would you expect their placement to be accurate? Answer Key "],["module-3-data-curation-and-data-sharing.html", "Module 3: Data Curation and Data Sharing Lecture Lab", " Module 3: Data Curation and Data Sharing Lecture Lab Data Curation and Sharing Lab The Infectious Disease Genomic Epidemiology “Data curation and sharing lab” is designed to give participants hands-on experience using curation tools to structure, standardize, and transform genomics contextual data. Users do not need to access or use the Amazon Web Services (AWS) for the purpose of this module. All exercises take place in documents, spreadsheets, or discussions, and webtools will be accessed using your local browser. Please refer to the lab instructions to get started. Excercise 1 Scenario Lab Instructions CanCOGeN Template Curation Reference Guide Link does not work EBI OLS Exercise Link does not work WHO Guiding Principles for Genomic Data Sharing "],["module-4-phylogenetic-analysis.html", "Module 4: Phylogenetic Analysis Lecture", " Module 4: Phylogenetic Analysis Lecture "],["module-5-viral-pathogen-genomic-analysis---single-nucleotide-variants.html", "Module 5: Viral Pathogen Genomic Analysis - Single Nucleotide Variants Lecture Lab: Virus Short-Read Genome Assembly and Variant Analysis", " Module 5: Viral Pathogen Genomic Analysis - Single Nucleotide Variants Lecture Lab: Virus Short-Read Genome Assembly and Variant Analysis Created by: Jared Simpson and Jalees Nasir Introduction In this lab we will perform reference-based analysis of Severe Acute Respiratory Syndrome Coronavirus 2 (SARS-CoV-2) short-read sequencing data. You will be guided through the analysis workflow and subsequent exploration of the data and quality control results. At the end of the lab you will know: How to analyze amplicon sequencing data from the Illumina sequencing instrument How to assess the quality of a sequenced sample How to assess single nucleotide polymorphisms (SNPs) for SARS-CoV-2 variant calls How to view the evolutionary changes of SARS-CoV-2 and interpret differences between lineages belonging to variants of concern (i.e., Alpha vs. Delta variants) Data Sets In this lab we will use subset of data from the COVID-19 Genomics UK Consortium (COG-UK) to demonstrate analysis of SARS-CoV-2. This data set consists of short-read sequencing reads collected as part of the COVID-19 Pandemic response and will be a mix of different variants of concern (VOCs) up to the end of summer 2021. This would include predominantly Alpha (also known as PANGO lineage B.1.1.7; first designated December 2020) and Delta (also known as PANGO lineage B.1.617.2; first designated in May 2021) variants. We have provided publicly available Illumina short-reads and you will run SARS-CoV-2 Illumina GeNome Assembly Line (SIGNAL) with additional quality control and assessment using ncov-tools. Prior to the workshop the instructors downsampled the sequencing data from ~10,000x coverage to ~200x coverage to reduce the time it takes to run the analysis; however, running the pipelines use the exact same set of commands and the results you will obtain are comparable to assembling using the full dataset. In the following instructions the commands you should run are shown in code blocks like so: echo &quot;Hello world&quot; You can type these commands into your terminal, or copy and paste them. Data Download and Preparation First, lets create and move to a directory that we’ll use to organize our results: mkdir -p workspace/module5 cd workspace/module5 From within your module5 directory, you can create a symlink which is a shortcut to where the raw sequencing data is stored: ln -s ~/CourseData/IDE_data/module5/cbw_demo_run/ If you run ls you should see only one directory: cbw_demo_run. You can view the contents of the cbw_demo_run directory using ls: ls cbw_demo_run You should see 36 pairs of files. Each pair of files is the raw sequencing data for a single sample. The first half of the Illumina paired-end reads is stored in files ending in _R1.fastq.gz and the second half in _R2.fastq.gz. The samples are identified with accession numbers like ERR5338522, a unique identifier of a sample that has been deposited in a public database. You can view the contents of one of the data files by decompressing it and piping it to head: zcat cbw_demo_run/ERR5338522_R1.fastq.gz | head Question: what do the different lines in a FASTQ file mean? If you can’t figure it out ask an instructor or on slack! Running SIGNAL The analysis of SARS-CoV-2 sequencing data is complex and uses a number of different tools that are run sequentially in a pipeline. The pipeline we will use to analyze this data is called SIGNAL. First, we need to clone a copy of SIGNAL from github and then enter the directory this command creates: git clone --recursive https://github.com/jaleezyy/covid-19-signal cd covid-19-signal Ensure that your current working directory is within the covid-19-signal directory using pwd. Next, we need to switch to the version of SIGNAL that we will use for this workshop. This version tells SIGNAL that we have installed all of the software we used in a single conda environment: git checkout single-conda Finally, we need to activate the conda environment containing the software SIGNAL requires, and create a symlink to the reference files SIGNAL needs. You can also review the SIGNAL help screen to see our options: conda activate signalcovtools ln -s ~/CourseData/IDE_data/module5/data/ python signalexe.py -h The data directory you have linked should be found within ~/workspace/module5/covid-19-signal/data. In order to run SIGNAL, we first need to prepare two files: a configuration file, where all of our assembly parameters will be assigned, and a sample table, which will list the indivdual samples and the location of corresponding R1 and R2 FASTQs. Remember that our sequencing data is located one directory level up (i.e., ../cbw_demo_run/). Generating the required files can all be done using the following command: python signalexe.py --directory ../cbw_demo_run --config-only The output should be as follows If you run ls you should see cbw_demo_run_config.yaml and cbw_demo_run_sample_table.csv files have been created. You can use more or less to examine the input files. Reference-based Assembly using SIGNAL Using our configuration file as input, we can begin our assembly of SARS-CoV-2 sequencing reads. Run the following: python signalexe.py --configfile cbw_demo_run_config.yaml --quiet --cores 4 all postprocess This will take around 30-45 minutes to run, so is a good time for a short break. Quality Control and Assessment Now that SIGNAL is complete, we will run an additional step to generate some quality control results: python signalexe.py --configfile cbw_demo_run_config.yaml --quiet --cores 4 ncov_tools Coverage Analysis We can now start exploring the results. First we will look at the depth of coverage to make sure that each viral genome was covered by enough sequencing reads to call an accurate consensus sequence. Open your web browser and navigate to http://xx.uhn-hpc.ca/module5/covid-19-signal/cbw_demo_run_results_dir/ where xx is the instance ID you were assigned. This directory stores the results of SIGNAL and ncov-tools. In the ncov-tools-results/plots/ subdirectory you will find a file called cbw_demo_run_results_dir_depth_by_position.pdf. Open this file. This file contains plots of the coverage depth for each of the 36 samples we analyzed as shown below. Explore the results and try to understand what the coverage patterns mean: What might have caused the sharp drop in coverage for sample ERR6035561? What about the uneven coverage in sample ERR5508530? As explained in the lecture, sequencing coverage is a critical factor for determining the completeness of the genome assembly. In the terminal, let’s view the consensus sequence for sample ERR5508530: less cbw_demo_run_results_dir/ERR5508530/freebayes/ERR5508530.consensus.fasta What do you see? The consensus sequences for other samples are in directories with similiar names, take a look at them. Can you draw any conclusions about the quality of the results? ncov-tools creates a file that summarizes the genome completeness for every sample. Run this command in the terminal: cut -f1,10,15 cbw_demo_run_results_dir/ncov-tools-results/qc_reports/cbw_demo_run_results_dir_summary_qc.tsv This command uses cut to find the metrics that we are interested in from the full QC results table. What is the completeness of ERR5508530? What about ERR6035561? Assessing SNP Calls Now, using your browser open the file located at ncov-tools-results/plots/cbw_demo_run_results_dir_tree_snps.pdf. This plot arranges the samples using a phylogenetic tree (shown on the left) so that samples with a similar sequence are grouped together. The panel on the right shows SNPs within each sample with respect to the MN908947.3 reference genome, where each colour represents a different base. Also shown on the plot are the pangolin-assigned lineages; B.1.1.7 is the alpha variant, AY.4 is delta. Notice that there are many SNPs in common between the alpha samples and a different set of SNPs in common between the delta samples. These SNPs are what define the different lineages. Now, we’re going to inspect the read-level evidence for some example SNPs. Open up IGV and using the first dropdown menu select the “SARS-CoV-2” genome. Now, click on the File menu and select “Load from URL” and paste in the path http://xx.uhn-hpc.ca/module5/covid-19-signal/cbw_demo_run_results_dir/ERR5389257/core/ERR5389257_viral_reference.mapping.bam again replacing xx with your instance ID. Once the file loads you will see the pattern of read coverage along the genome. Paste the coordinates NC_045512.2:2,917-3,156 into the navigation bar. This region shows a single C&gt;T SNP where every read supports the alternative allele (the red bars in the middle of the screen). Now, navigate to NC_045512.2:631-870. In this case some reads have evidence for a C&gt;T SNP but other reads have evidence for the reference allele at this position. Since this position is ambiguous the consensus genome will be marked with an ambiguity code. Going back to the mutations plot, look for the row corresponding to sample ERR5389257. Notice that it has a black bar in between two purple SNPs at the beginning of the genome - that is the ambiguous position that we are inspecting at IGV. Since this position is only ambiguous in ERR5389257 we can’t draw many conclusions from it - it could be due to low-level contamination, a PCR artificat, or heterogeneity within this sample. You can view all of the variants for a sample by using less on their VCF files: less cbw_demo_run_results_dir/ERR5389257/freebayes/ERR5389257.variants.norm.vcf Take a bit of time to look at other variants for this sample (or other samples!). If you find something interesting or unexpected tell the rest of the class in slack and we can discuss it as a group. Variant Consequence Prediction Once we have variant calls we can run a mutation consequence predictor to determine the protein-level changes. This is important as the identification of new variants relies on determining whether the mutations increase the fitness of the lineage, which is usually determined at the amino acid level. View this file in your terminal: less cbw_demo_run_results_dir/ncov-tools-results/qc_annotation/ERR5389257_aa_table.tsv This file is a table of predicted amino acid changes for each protein. How many changes to the spike protein does this sample have? Let’s compare that number to a different sample from another lineage. First, let’s figure out the lineage of sample ERR5389257: grep ERR5389257 cbw_demo_run_results_dir/lineage_assignments.tsv The file lineage_assignments.tsv is produced by pangolin and by grepping (searching the file) for sample ERR5389257 we can see that it is B.1.1.7 (Alpha). Look in the lineage_assignments.tsv file to find the identifier for a delta sample, then use it’s consequence prediction file to count the number of spike mutations. Is it more or less than ERR5389257? We probably wouldn’t want to draw strong conclusions from the number of mutations as many will be neutral (or even deleterious) but this type of analysis - looking at mutation consequence - cross-referenced with other data (for example experimental fitness assays) is what goes into identifying VOCs. "]]
